#include <AT89X52.h>
#define uchar unsigned char
#define uint unsigned int    //宏定义
#define KEY P3_7      //定义画面切换按键
uchar KY;    //KY作用在后面说明     
uchar disp;     //显示汉字指针
uchar pic=0,num=0;     //pic为按键次数；num为中断次数


uchar code love[] = {
 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */

0x00,0x04,0xFC,0x07,0x44,0x04,0x44,0x04,0xFC,0x02,0x00,0x01,/*"B",0*/
/* (6 X 13 , 宋体 ) */

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",1*/
/* (6 X 13 , 宋体 ) */

0x00,0x00,0xFC,0x03,0x00,0x04,0x00,0x04,0xFC,0x03,0x00,0x00,/*"U",2*/
/* (6 X 13 , 宋体 ) */

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (6 X 13 , 宋体 ) */

0x00,0x04,0xFC,0x07,0x44,0x04,0x44,0x00,0x2C,0x00,0x10,0x00,/*"P",4*/
/* (6 X 13 , 宋体 ) */

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",5*/
/* (6 X 13 , 宋体 ) */

0x08,0x00,0x04,0x00,0xFC,0x07,0x04,0x04,0x04,0x00,0x08,0x00,


};


uchar code loveyou[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x78,0x00,0xFC,0x00,0xFE,0x01,0xFE,0x03,0xFE,0x07,0xFE,0x0F,0xFE,0x1F,0xFC,0x3F,
0xF8,0x7F,0xFC,0x3F,0xFE,0x1F,0xFE,0x0F,0xFE,0x07,0xFE,0x03,0xFE,0x01,0xFC,0x00,
0x78,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*心形图案*/
};

uchar code hehe[] = {

0x00,0x01,0x00,0x41,0x02,0x41,0x82,0x44,0x86,0x44,0x4A,0x44,0x52,0x44,0x22,0x7F,
0x52,0x44,0x4A,0x44,0x86,0x44,0x82,0x44,0x00,0x41,0x00,0x41,0x00,0x01,0x00,0x00,/*"圣",0*/
/* (16 X 16 , 宋体 ) */

0x40,0x00,0x42,0x00,0xCC,0x3F,0x00,0x90,0x44,0x4B,0x64,0x24,0x54,0x18,0xCC,0x17,
0x00,0x20,0xE4,0x4F,0x04,0x48,0xFE,0x4F,0x43,0x48,0x42,0x48,0x00,0x40,0x00,0x00,/*"诞",1*/
/* (16 X 16 , 宋体 ) */

0x00,0x01,0xE0,0x00,0x00,0x00,0xFF,0xFF,0x10,0x00,0x20,0x81,0x08,0x41,0x08,0x31,
0x08,0x0D,0xFF,0x03,0x08,0x0D,0x08,0x31,0xF8,0x41,0x00,0x81,0x00,0x81,0x00,0x00,/*"快",2*/
/* (16 X 16 , 宋体 ) */

0x00,0x00,0x00,0x20,0xE0,0x10,0x9C,0x08,0x84,0x06,0x84,0x40,0x84,0x80,0xF4,0x7F,
0x82,0x00,0x82,0x00,0x83,0x02,0x82,0x04,0x80,0x08,0x80,0x30,0x00,0x00,0x00,0x00,/*"乐",3*/
/* (16 X 16 , 宋体 ) */



};

unsigned char code hanzi[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */
0x00,0x00,0xC4,0x03,0xC4,0x43,0x44,0x42,0x44,0x62,0x7C,0x3E,0x80,0x00,0x80,0x40,
0xFE,0x7F,0x80,0x60,0xE0,0x31,0xB0,0x0E,0x8C,0x18,0x84,0x20,0x80,0x60,0x00,0x00,/*"张",0*/
/* (16 X 16 , 黑体 ) */

0x00,0x00,0xF8,0x1F,0x08,0x04,0x08,0x04,0xF8,0x2F,0x00,0x20,0x90,0x18,0x90,0x0E,
0x92,0xC1,0xF2,0x7F,0xF4,0x7F,0x0C,0x03,0x80,0x0C,0x60,0x18,0x00,0x30,0x00,0x00,/*"咏",1*/
/* (16 X 16 , 黑体 ) */

0x00,0x00,0xC0,0x40,0xC4,0x60,0xC4,0x20,0xC4,0x30,0xC4,0x18,0xC4,0x0E,0xFC,0x03,
0xFC,0x03,0xC4,0x06,0xC4,0x18,0xC4,0x10,0xC4,0x20,0xC0,0x60,0xC0,0x40,0x00,0x00,/*"天",2*/
/* (16 X 16 , 黑体 ) */



0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */
0x00,0x00,0x20,0x0C,0xA0,0x03,0xFE,0x7F,0xFE,0x7F,0xB0,0x11,0x30,0x19,0xC4,0x48,
0x44,0x66,0xE4,0x33,0x54,0x18,0xDC,0x07,0xCC,0x40,0x44,0x70,0xC0,0x3F,0x00,0x00,/*"杨",4*/
/* (16 X 16 , 黑体 ) */

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */


0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",7*/
/* (8 X 16 , 黑体 ) */

0x00,0x00,0xF8,0x0F,0x98,0x04,0xFE,0xFF,0xFE,0xFF,0x98,0x04,0xF8,0x0F,0x00,0x18,
0xC4,0x6C,0xE4,0x23,0xE4,0x18,0x54,0x0E,0xCC,0x43,0x4C,0x40,0xC4,0x7F,0x00,0x00,/*"畅",8*/
/* (16 X 16 , 黑体 ) */

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",9*/
/* (8 X 16 , 黑体 ) */

 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",7*/
/* (8 X 16 , 黑体 ) */
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",3*/
/* (8 X 16 , 黑体 ) */
0x00,0x00,0x80,0x00,0x84,0x00,0x84,0x00,0x84,0x00,0x84,0x40,0x84,0x40,0xFC,0x7F,
0xFC,0x3F,0x84,0x00,0x84,0x00,0x84,0x00,0x84,0x00,0x80,0x00,0x80,0x00,0x00,0x00,/*"于",10*/
/* (16 X 16 , 黑体 ) */

0x00,0x00,0x80,0x00,0x80,0x60,0x80,0x30,0x90,0x18,0x90,0x0F,0x92,0xC1,0x16,0x40,
0xF4,0x7F,0x8C,0x01,0x00,0x07,0x00,0x0D,0x80,0x18,0xC0,0x30,0x00,0x20,0x00,0x00,/*"永",11*/
/* (16 X 16 , 黑体 ) */

0x00,0x40,0x00,0x70,0xFC,0x1F,0x24,0x02,0x24,0x42,0xFC,0x7F,0x80,0x00,0xE0,0x42,
0x38,0x42,0x20,0x42,0xFE,0x7F,0x20,0x42,0x20,0x42,0x20,0x42,0x00,0x40,0x00,0x00,/*"胜",12*/
/* (16 X 16 , 黑体 ) */



};

/*****函数声明*****/
void display1_ltor(void);
void display2_ltor(void);
void display2_rtol(void);
void display3(void);
void display4(void);






/*****n（us）延时子程序*****/
void DelayUs(uint N)
{
 uint x;
 for(x=0; x<=N;x++);
}

/*****中断服务程序*****/
void intersvr0(void) interrupt 0 
{
 ;
 KY=~KY;      //每个摇动来回水银开关会在摆幅两端分别产生下降沿中断，只提取其中一次（从左向右摇才显示）
 if(KY==0)
 {
   num++;     //计算中断次数
   switch(pic)      //选择画面
   {
        case 0:{display1_ltor();}break;
    case 1:{display2_ltor();}break;
    case 2:{display3();}break;
    case 3:{display4();}break;
    default:{display1_ltor();}  
   }
 }

}
/*****显示子程序1（汉字）*****/
void display1_ltor(void)
{
 uchar i;
 if(num>10){disp++;num=0;}     //12个汉字分为3次显示完（每次显示4个），每中断10次切换
 if(disp>2)disp=0;
  DelayUs(5200);     //此处延时时间依各硬件差别而各不相同，试着调整使得显示内容居中即可
 for(i=0;i<64;i++)
 {
     P0=~hanzi[disp*128+i*2];
     P2=~hanzi[disp*128+i*2+1];
     DelayUs(100);
 }
}

/*****显示子程序2（LOVE）*****/
void display2_ltor(void)
{
 uchar i;
 DelayUs(4000);
 for(i=0;i<64;i++) 
 {
     P0=~love[i*2];
     P2=~love[i*2+1];
     DelayUs(140);
 }
}
/*****显示子程序3（心形图案）*****/
void display3(void)
{
 uchar i;
  DelayUs(4000);
 for(i=0;i<64;i++)
 {
     P0=~loveyou[i*2];
     P2=~loveyou[i*2+1];
     DelayUs(120);
 }
}

/*****显示子程序4（呵呵o(∩_∩)o图案）*****/
void display4(void)
{
 uchar i;
 DelayUs(4000);
 for(i=0;i<64;i++)
 {
     P0=~hehe[i*2];
     P2=~hehe[i*2+1];
     DelayUs(120);
 }
}

/*****主函数*****/
void main(void)
{
 IT0=1;
 EX0=1;
 EA=1;      //开中断，下降沿中断
 KY=0;
 KEY=1;
 while(1)     //主程序中只检测按键
 {
  if(KEY==0)     //画面切换键按下
  {
     DelayUs(10000);     //按键去抖
     if(KEY==0);
     pic++;
     while(KEY==0);
  }
  if(pic>3)pic=0;
 }
}
/*****END*****/





